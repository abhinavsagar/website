<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>How to Easily Deploy Machine Learning Models Using Flask</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">How to Easily Deploy Machine Learning Models Using Flask</h1>
</header>
<section data-field="subtitle" class="p-summary">
And take your models from jupyter notebook to production
</section>
<section data-field="body" class="e-content">
<section name="78e1" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c86a" id="c86a" class="graf graf--h3 graf--leading graf--title">How to Easily Deploy Machine Learning Models Using Flask</h3><h4 name="9486" id="9486" class="graf graf--h4 graf-after--h3 graf--subtitle">And take your models from jupyter notebook to production</h4></div><div class="section-inner sectionLayout--fullWidth"><figure name="1d11" id="1d11" class="graf graf--figure graf--layoutFillWidth graf-after--h4"><img class="graf-image" data-image-id="1*pB5Yhj_4dx4hyrr-d-Ck4w.jpeg" data-width="3000" data-height="2000" src="https://cdn-images-1.medium.com/max/2560/1*pB5Yhj_4dx4hyrr-d-Ck4w.jpeg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@spacex?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/@spacex?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">SpaceX</a> on <a href="https://unsplash.com/s/photos/rocket-launch?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/s/photos/rocket-launch?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Unsplash</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="b687" id="b687" class="graf graf--p graf-after--figure">Stuck behind the paywall? Click <a href="https://medium.com/p/how-to-easily-deploy-machine-learning-models-using-flask-b95af8fe34d4?source=email-c3f5233f3441--writer.postDistributed&amp;sk=9db80eba5a150458734179050ddcab1c" data-href="https://medium.com/p/how-to-easily-deploy-machine-learning-models-using-flask-b95af8fe34d4?source=email-c3f5233f3441--writer.postDistributed&amp;sk=9db80eba5a150458734179050ddcab1c" class="markup--anchor markup--p-anchor" target="_blank">here</a> to read the full story with my Friend Link!</p><p name="12f8" id="12f8" class="graf graf--p graf-after--p">When a data scientist/machine learning engineer develops a machine learning model using Scikit-Learn, TensorFlow, Keras, PyTorch etc, the ultimate goal is to make it available in production. Often times when working on a machine learning project, we focus a lot on Exploratory Data Analysis(EDA), Feature Engineering, tweaking with hyper-parameters etc. But we tend to forget our main goal, which is to extract real value from the model predictions.</p><p name="9be3" id="9be3" class="graf graf--p graf-after--p">Deployment of machine learning models or putting models into production means making your models available to the end users or systems. However, there is complexity in the deployment of machine learning models. This post aims to make you get started with putting your trained machine learning models into production using Flask API.</p><p name="6154" id="6154" class="graf graf--p graf-after--p">I will be using linear regression to predict the sales value in the third month using rate of interest and sales of the first two months.</p><h3 name="b207" id="b207" class="graf graf--h3 graf-after--p">What is Linear Regression</h3><p name="35c1" id="35c1" class="graf graf--p graf-after--h3">The objective of a linear regression model is to find a relationship between one or more features(independent variables) and a continuous target variable(dependent variable). When there is only feature it is called <em class="markup--em markup--p-em">Uni-variate</em> Linear Regression and if there are multiple features, it is called <em class="markup--em markup--p-em">Multi</em>ple Linear Regression.</p><h3 name="4882" id="4882" class="graf graf--h3 graf-after--p">Hypothesis of Linear Regression</h3><p name="e4bf" id="e4bf" class="graf graf--p graf-after--h3">The linear regression model can be represented by the following equation</p><figure name="c68a" id="c68a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*sy3_rBdtu0rIBGVY" data-width="60" data-height="4" src="https://cdn-images-1.medium.com/max/800/0*sy3_rBdtu0rIBGVY"></figure><figure name="ef7e" id="ef7e" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="0*PXhNMlJD356FaDpA.png" data-width="313" data-height="21" src="https://cdn-images-1.medium.com/max/800/0*PXhNMlJD356FaDpA.png"></figure><ul class="postList"><li name="e6af" id="e6af" class="graf graf--li graf-after--figure"><em class="markup--em markup--li-em">Y</em> is the predicted value</li><li name="ba03" id="ba03" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">θ</em>₀ is the bias term.</li><li name="7d57" id="7d57" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">θ</em>₁,…,<em class="markup--em markup--li-em">θ</em>ₙ are the model parameters</li><li name="b4de" id="b4de" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">x</em>₁, <em class="markup--em markup--li-em">x</em>₂,…,<em class="markup--em markup--li-em">x</em>ₙ are the feature values.</li></ul><figure name="14ba" id="14ba" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*QiU6DcP_r9qWLznMw0-M_Q.png" data-width="640" data-height="480" src="https://cdn-images-1.medium.com/max/800/1*QiU6DcP_r9qWLznMw0-M_Q.png"><figcaption class="imageCaption">Linear regression illustrated</figcaption></figure><h3 name="6945" id="6945" class="graf graf--h3 graf-after--figure">Why Flask?</h3><ul class="postList"><li name="1cc0" id="1cc0" class="graf graf--li graf-after--h3">Easy to use.</li><li name="9633" id="9633" class="graf graf--li graf-after--li">Built in development server and debugger.</li><li name="4b1a" id="4b1a" class="graf graf--li graf-after--li">Integrated unit testing support.</li><li name="beb7" id="beb7" class="graf graf--li graf-after--li">RESTful request dispatching.</li><li name="5b39" id="5b39" class="graf graf--li graf-after--li">Extensively documented.</li></ul><h3 name="7472" id="7472" class="graf graf--h3 graf-after--li">Project Structure</h3><p name="89d8" id="89d8" class="graf graf--p graf-after--h3">This project has four parts :</p><ol class="postList"><li name="3fac" id="3fac" class="graf graf--li graf-after--p">model.py — This contains code for the machine learning model to predict sales in the third month based on the sales in the first two months.</li><li name="b07b" id="b07b" class="graf graf--li graf-after--li">app.py — This contains Flask APIs that receives sales details through GUI or API calls, computes the predicted value based on our model and returns it.</li><li name="c5e9" id="c5e9" class="graf graf--li graf-after--li">request.py — This uses requests module to call APIs defined in app.py and displays the returned value.</li><li name="ce1d" id="ce1d" class="graf graf--li graf-after--li">HTML/CSS — This contains the HTML template and CSS styling to allow user to enter sales detail and displays the predicted sales in the third month.</li></ol><figure name="097a" id="097a" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*R6MR34xT4Ve6fI744EVN0A.png" data-width="575" data-height="376" src="https://cdn-images-1.medium.com/max/800/1*R6MR34xT4Ve6fI744EVN0A.png"><figcaption class="imageCaption">Pipeline for deployment of a Machine Learning model</figcaption></figure><h3 name="8074" id="8074" class="graf graf--h3 graf-after--figure">Environment and tools</h3><ol class="postList"><li name="63d2" id="63d2" class="graf graf--li graf-after--h3">scikit-learn</li><li name="f7a3" id="f7a3" class="graf graf--li graf-after--li">pandas</li><li name="5e08" id="5e08" class="graf graf--li graf-after--li">numpy</li><li name="0a44" id="0a44" class="graf graf--li graf-after--li">flask</li></ol><h3 name="818e" id="818e" class="graf graf--h3 graf-after--li">Where is the code?</h3><p name="be28" id="be28" class="graf graf--p graf-after--h3">Without much ado, let’s get started with the code. The complete project on github can be found <a href="https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials" data-href="https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><p name="c678" id="c678" class="graf graf--p graf-after--p">Let’s get started with making the front end using HTML for the user to input the values. There are three fields which need to be filled by the user — rate of interest, sales in first month and sales in second month.</p><figure name="0296" id="0296" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/58294884a5ce79f0d76e28ec3bf955f6.js"></script></figure><p name="31ce" id="31ce" class="graf graf--p graf-after--figure">Next I did some styling using CSS for the input button, login buttons and the background.</p><figure name="cc86" id="cc86" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/eaf81353445d1159d6544cc493cf7681.js"></script></figure><p name="f59b" id="f59b" class="graf graf--p graf-after--figure">I created a custom sales dataset for this project which has four columns — rate of interest, sales in first month, sales in second month and sales in third month.</p><figure name="f761" id="f761" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/58eeff55a60b30321f32ac4a66ff5e06.js"></script></figure><p name="10b1" id="10b1" class="graf graf--p graf-after--figure">Let’s now make a machine learning model to predict sales in the third month. First let’s deal with missing values using Pandas. Missing Data can occur when no information is provided for one or more items. I filled the rate column with zero and sales in first month with mean of that column if the value was not provided. I used linear regression as the machine learning algorithm.</p><h3 name="105d" id="105d" class="graf graf--h3 graf-after--p">Serializing/De-Serializing</h3><p name="23e2" id="23e2" class="graf graf--p graf-after--h3">In simple words serializing is a way to write a python object on the disk that can be transferred anywhere and later de-serialized (read) back by a python script.</p><figure name="a6e7" id="a6e7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Menz4NWvM6Ca8H6B0d6VrQ.png" data-width="373" data-height="312" src="https://cdn-images-1.medium.com/max/800/1*Menz4NWvM6Ca8H6B0d6VrQ.png"><figcaption class="imageCaption">Serialization, De-Serialization</figcaption></figure><p name="9a18" id="9a18" class="graf graf--p graf-after--figure">I converted the model which is in the form of a python object into a character stream using pickling. The idea is that this character stream contains all the information necessary to reconstruct the object in another python script.</p><figure name="5883" id="5883" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/d978d05b8d7c6047c4ef37a2d5d89e66.js"></script></figure><p name="9349" id="9349" class="graf graf--p graf-after--figure">The next part was to make an API which receives sales details through GUI and computes the predicted sales value based on our model. For this I de- serialized the pickled model in the form of python object. I set the main page using <code class="markup--code markup--p-code">index.html</code>. On submitting the form values using POST request to <code class="markup--code markup--p-code">/predict</code>, we get the predicted sales value.</p><p name="26cc" id="26cc" class="graf graf--p graf-after--p">The results can be shown by making another POST request to <code class="markup--code markup--p-code">/results.</code> It receives JSON inputs, uses the trained model to make a prediction and returns that prediction in JSON format which can be accessed through the API endpoint.</p><figure name="ea48" id="ea48" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/929c7812a65e5e7b7c7e73e5353854f1.js"></script></figure><p name="fcf9" id="fcf9" class="graf graf--p graf-after--figure">Finally I used requests module to call APIs defined in <code class="markup--code markup--p-code">app.py</code>. It displays the returned sales value in the third month.</p><figure name="2e44" id="2e44" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/962154fd197b22327cb364dee0a62353.js"></script></figure><h3 name="6f14" id="6f14" class="graf graf--h3 graf-after--figure">Results</h3><p name="5e07" id="5e07" class="graf graf--p graf-after--h3">Run the web application using this command.</p><pre name="9082" id="9082" class="graf graf--pre graf-after--p">$ python app.py</pre><figure name="9046" id="9046" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*KslU_eRP25IGPSEHIB0LbA.png" data-width="762" data-height="202" src="https://cdn-images-1.medium.com/max/800/1*KslU_eRP25IGPSEHIB0LbA.png"></figure><p name="d5ba" id="d5ba" class="graf graf--p graf-after--figure">Open <a href="http://127.0.0.1:5000/" data-href="http://127.0.0.1:5000/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">http://127.0.0.1:5000/</a> in your web-browser, and the GUI as shown below should appear.</p><figure name="3cc5" id="3cc5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*TajI7H3AvWZcxzK4UUxyIQ.png" data-width="541" data-height="509" src="https://cdn-images-1.medium.com/max/800/1*TajI7H3AvWZcxzK4UUxyIQ.png"><figcaption class="imageCaption">Graphical user interface</figcaption></figure><h3 name="dd82" id="dd82" class="graf graf--h3 graf-after--figure">Conclusions</h3><p name="3b55" id="3b55" class="graf graf--p graf-after--h3">This article demonstrated a very simple way to deploy machine learning models. I used linear regression to predict sales value in the third month using rate of interest and sales in first two months. One can use the knowledge gained in this blog to make some cool models and take them into production so that others can appreciate their work.</p><h3 name="7071" id="7071" class="graf graf--h3 graf-after--p">References/Further Readings</h3><div name="e17f" id="e17f" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://towardsdatascience.com/writing-a-simple-flask-web-application-in-80-lines-cb5c386b089a" data-href="https://towardsdatascience.com/writing-a-simple-flask-web-application-in-80-lines-cb5c386b089a" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://towardsdatascience.com/writing-a-simple-flask-web-application-in-80-lines-cb5c386b089a"><strong class="markup--strong markup--mixtapeEmbed-strong">Writing a simple Flask Web Application in 80 lines</strong><br><em class="markup--em markup--mixtapeEmbed-em">Sample tutorial for getting started with flask</em>towardsdatascience.com</a><a href="https://towardsdatascience.com/writing-a-simple-flask-web-application-in-80-lines-cb5c386b089a" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="0199e1dfd9eca3868ffa77a9b2c260af" data-thumbnail-img-id="1*Mjswhy4dihQh4hP4WKs6Aw.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*Mjswhy4dihQh4hP4WKs6Aw.jpeg);"></a></div><div name="6fb6" id="6fb6" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://www.coursera.org/learn/deploying-machine-learning-models" data-href="https://www.coursera.org/learn/deploying-machine-learning-models" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://www.coursera.org/learn/deploying-machine-learning-models"><strong class="markup--strong markup--mixtapeEmbed-strong">Deploying Machine Learning Models | Coursera</strong><br><em class="markup--em markup--mixtapeEmbed-em">Learn Deploying Machine Learning Models from University of California San Diego. In this course we will learn about…</em>www.coursera.org</a><a href="https://www.coursera.org/learn/deploying-machine-learning-models" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="800681ee153924e8bd81da2154e67e38" data-thumbnail-img-id="0*i70WEiB89JxaXTy8" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*i70WEiB89JxaXTy8);"></a></div><div name="6335" id="6335" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://towardsdatascience.com/simple-way-to-deploy-machine-learning-models-to-cloud-fd58b771fdcf" data-href="https://towardsdatascience.com/simple-way-to-deploy-machine-learning-models-to-cloud-fd58b771fdcf" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://towardsdatascience.com/simple-way-to-deploy-machine-learning-models-to-cloud-fd58b771fdcf"><strong class="markup--strong markup--mixtapeEmbed-strong">Simple way to deploy machine learning models to cloud</strong><br><em class="markup--em markup--mixtapeEmbed-em">Deploy your first ML model to production with a simple tech stack</em>towardsdatascience.com</a><a href="https://towardsdatascience.com/simple-way-to-deploy-machine-learning-models-to-cloud-fd58b771fdcf" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="bf48b4d9cdc303ee79f2e05d19608558" data-thumbnail-img-id="1*gGCTKQ7AIKVVnKXYN2rgvA.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*gGCTKQ7AIKVVnKXYN2rgvA.png);"></a></div><div name="a22e" id="a22e" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://www.kdnuggets.com/2019/06/approaches-deploying-machine-learning-production.html" data-href="https://www.kdnuggets.com/2019/06/approaches-deploying-machine-learning-production.html" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://www.kdnuggets.com/2019/06/approaches-deploying-machine-learning-production.html"><strong class="markup--strong markup--mixtapeEmbed-strong">Overview of Different Approaches to Deploying Machine Learning Models in Production - KDnuggets</strong><br><em class="markup--em markup--mixtapeEmbed-em">There are different approaches to putting models into productions, with benefits that can vary dependent on the…</em>www.kdnuggets.com</a><a href="https://www.kdnuggets.com/2019/06/approaches-deploying-machine-learning-production.html" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="9b57be46ca32b4c6292c32f023f66a21" data-thumbnail-img-id="0*BqiLjOcZRqp_mz5D" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*BqiLjOcZRqp_mz5D);"></a></div><h3 name="a42e" id="a42e" class="graf graf--h3 graf-after--mixtapeEmbed">Before You Go</h3><p name="29ac" id="29ac" class="graf graf--p graf-after--h3">The corresponding source code can be found here.</p><div name="6831" id="6831" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials" data-href="https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials"><strong class="markup--strong markup--mixtapeEmbed-strong">abhinavsagar/Machine-Learning-Deployment-Tutorials</strong><br><em class="markup--em markup--mixtapeEmbed-em">Sample end to end projects from data collection to putting models into production …</em>github.com</a><a href="https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="95b03b3436a63ab1ff5b69234cc9a8b9"></a></div><h3 name="1182" id="1182" class="graf graf--h3 graf-after--mixtapeEmbed">Contacts</h3><p name="60bd" id="60bd" class="graf graf--p graf-after--h3">If you want to keep updated with my latest articles and projects <a href="https://medium.com/@abhinav.sagar" data-href="https://medium.com/@abhinav.sagar" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">follow me on Medium</a>. These are some of my contacts details:</p><ul class="postList"><li name="f946" id="f946" class="graf graf--li graf-after--p"><a href="https://abhinavsagar.github.io/" data-href="https://abhinavsagar.github.io/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Personal Website</a></li><li name="c61d" id="c61d" class="graf graf--li graf-after--li"><a href="https://in.linkedin.com/in/abhinavsagar4" data-href="https://in.linkedin.com/in/abhinavsagar4" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Linkedin</a></li><li name="5fd5" id="5fd5" class="graf graf--li graf-after--li"><a href="https://medium.com/@abhinav.sagar" data-href="https://medium.com/@abhinav.sagar" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Medium Profile</a></li><li name="0902" id="0902" class="graf graf--li graf-after--li"><a href="https://github.com/abhinavsagar" data-href="https://github.com/abhinavsagar" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">GitHub</a></li><li name="2119" id="2119" class="graf graf--li graf-after--li"><a href="https://www.kaggle.com/abhinavsagar" data-href="https://www.kaggle.com/abhinavsagar" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Kaggle</a></li></ul><p name="a802" id="a802" class="graf graf--p graf-after--li graf--trailing">Happy reading, happy learning and happy coding.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@abhinav.sagar" class="p-author h-card">Abhinav Sagar</a> on <a href="https://medium.com/p/b95af8fe34d4"><time class="dt-published" datetime="2019-10-02T08:39:42.513Z">October 2, 2019</time></a>.</p><p><a href="https://medium.com/@abhinav.sagar/how-to-easily-deploy-machine-learning-models-using-flask-b95af8fe34d4" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 28, 2021.</p></footer></article></body></html>