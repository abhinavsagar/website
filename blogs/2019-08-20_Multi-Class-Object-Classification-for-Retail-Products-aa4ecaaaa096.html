<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Multi Class Object Classification for Retail Products</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Multi Class Object Classification for Retail Products</h1>
</header>
<section data-field="subtitle" class="p-summary">
Computer vision for friction-less store experience.
</section>
<section data-field="body" class="e-content">
<section name="70f2" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="be90" id="be90" class="graf graf--h3 graf--leading graf--title">Multi Class Object Classification for Retail Products</h3><h4 name="5d94" id="5d94" class="graf graf--h4 graf-after--h3 graf--subtitle">Computer vision for friction-less store experience.</h4></div><div class="section-inner sectionLayout--fullWidth"><figure name="19ad" id="19ad" class="graf graf--figure graf--layoutFillWidth graf-after--h4"><img class="graf-image" data-image-id="1*empB65v51mQ65lXohvlmRw.jpeg" data-width="5773" data-height="3849" src="https://cdn-images-1.medium.com/max/2560/1*empB65v51mQ65lXohvlmRw.jpeg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@fikrirasyid?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/@fikrirasyid?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Fikri Rasyid</a> on <a href="https://unsplash.com/search/photos/grocery-store?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/search/photos/grocery-store?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Unsplash</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="5030" id="5030" class="graf graf--p graf-after--figure">Stuck behind the paywall? Click <a href="https://towardsdatascience.com/multi-class-object-classification-for-retail-products-aa4ecaaaa096?source=friends_link&amp;sk=a09cd7d1715635d2519b1f10a3bf06f6" data-href="https://towardsdatascience.com/multi-class-object-classification-for-retail-products-aa4ecaaaa096?source=friends_link&amp;sk=a09cd7d1715635d2519b1f10a3bf06f6" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a> to read the full story with my Friend Link!</p><p name="9d67" id="9d67" class="graf graf--p graf-after--p">Retail has never been a stagnant industry. Retailers just can not afford to stand still if they want to succeed. They must adapt and innovate or risk being left behind.</p><p name="3699" id="3699" class="graf graf--p graf-after--p">The application of computer vision in retail is set to fundamentally change the shopping experience for customers and retailers. In this blog I will be making a computer vision based multi class object classification model for retail products. This project has been inspired from the famous <a href="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011" data-href="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Amazon Go</a> store. I hope you enjoy this article and find it insightful.</p><p name="cc18" id="cc18" class="graf graf--p graf-after--p">Amazon describes Amazon Go as a new kind of store with no checkout required. That means when you shop at Amazon Go, you’ll never have to wait in line. The store works with an Amazon Go application — you enter Amazon Go, take the products you want and thanks to the app just leave again. It works by using the same types of technologies found in self-driving cars, such as computer vision, sensor fusion and deep learning. This technology can detect when products are taken or returned to the shelves and keeps track of them in your virtual cart. When you leave the store with your goods, your Amazon account is charged and you are sent a receipt.</p><p name="2735" id="2735" class="graf graf--p graf-after--p">Here is the video in case you want to check it out.</p><figure name="f2fc" id="f2fc" class="graf graf--figure graf--iframe graf-after--p"><iframe src="https://www.youtube.com/embed/NrmMk1Myrxc?feature=oembed" width="700" height="393" frameborder="0" scrolling="no"></iframe></figure><h3 name="1df4" id="1df4" class="graf graf--h3 graf-after--figure">Applications of Computer Vision in Retail</h3><ol class="postList"><li name="02d4" id="02d4" class="graf graf--li graf-after--h3">Customizing experiences using facial recognition.</li><li name="ea29" id="ea29" class="graf graf--li graf-after--li">Making shopping feel more human and less transactional.</li><li name="b210" id="b210" class="graf graf--li graf-after--li">Computer Vision based inventory management.</li><li name="4695" id="4695" class="graf graf--li graf-after--li">Blurring the line between in-store and online.</li><li name="409c" id="409c" class="graf graf--li graf-after--li">The friction-less store experience.</li></ol><h3 name="028e" id="028e" class="graf graf--h3 graf-after--li">Data</h3><p name="1a0f" id="1a0f" class="graf graf--p graf-after--h3">I have used Freiburg Groceries Dataset for this project. It consists of 5000 256x256 RGB images of 25 food classes. The paper can be found <a href="https://arxiv.org/pdf/1611.05799.pdf" data-href="https://arxiv.org/pdf/1611.05799.pdf" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a> and the dataset <a href="http://aisdatasets.informatik.uni-freiburg.de/freiburg_groceries_dataset" data-href="http://aisdatasets.informatik.uni-freiburg.de/freiburg_groceries_dataset" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a>.</p><h3 name="7998" id="7998" class="graf graf--h3 graf-after--p">Environment and tools</h3><ol class="postList"><li name="8046" id="8046" class="graf graf--li graf-after--h3">Numpy</li><li name="8fb1" id="8fb1" class="graf graf--li graf-after--li">Pandas</li><li name="eb8a" id="eb8a" class="graf graf--li graf-after--li">Scikit-image</li><li name="9449" id="9449" class="graf graf--li graf-after--li">Matplotlib</li><li name="3bbd" id="3bbd" class="graf graf--li graf-after--li">Scikit-learn</li><li name="6176" id="6176" class="graf graf--li graf-after--li">Keras</li></ol><h3 name="774a" id="774a" class="graf graf--h3 graf-after--li">Image Classification</h3><p name="09f7" id="09f7" class="graf graf--p graf-after--h3">The complete image classification pipeline can be formalized as follows:</p><ul class="postList"><li name="2af9" id="2af9" class="graf graf--li graf-after--p">Our input is a training dataset that consists of <em class="markup--em markup--li-em">N</em> images, each labeled with one of 25 different classes.</li><li name="6d1f" id="6d1f" class="graf graf--li graf-after--li">Then, we use this training set to train a classifier to learn what every one of the classes looks like.</li><li name="bb95" id="bb95" class="graf graf--li graf-after--li">In the end, we evaluate the quality of the classifier by asking it to predict labels for a new set of images that it has never seen before. We will then compare the true labels of these images to the ones predicted by the classifier.</li></ul><h3 name="92ee" id="92ee" class="graf graf--h3 graf-after--li">Where is the code?</h3><p name="0924" id="0924" class="graf graf--p graf-after--h3">Without much ado, let’s get started with the code. The complete project on github can be found <a href="https://github.com/abhinavsagar/Grocery-Image-Classification" data-href="https://github.com/abhinavsagar/Grocery-Image-Classification" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><p name="8d4e" id="8d4e" class="graf graf--p graf-after--p">I started with loading all the libraries and dependencies.</p><figure name="f8c5" id="f8c5" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/4fdd5bf971743804885ca4d3a75b2866.js"></script></figure><p name="7de8" id="7de8" class="graf graf--p graf-after--figure">Next I made a function to plot loss and accuracy which we will get after training the model.</p><figure name="9780" id="9780" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/5f5500dcae24d47860636df7ab847505.js"></script></figure><p name="7d9e" id="7d9e" class="graf graf--p graf-after--figure">Also I made a couple of functions to return the label of a particular image and load the dataset.</p><figure name="0da5" id="0da5" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/78aa541084a2ff59ba8b3ec5b5809fa4.js"></script></figure><p name="3e8c" id="3e8c" class="graf graf--p graf-after--figure">I continued with making separate classes for each and every product and called the function to load all the images for every class.</p><figure name="36a2" id="36a2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/f68b4b67056a93c1a3d09fa64a59ac41.js"></script></figure><p name="f532" id="f532" class="graf graf--p graf-after--figure">Next I converted the images to categorical format before finally normalizing the images. Also I split the dataset into 2 parts — training set with 80% of data and testing set with 20%.</p><figure name="75da" id="75da" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/ced3c5cb3e88e02364c60a9c2d3f2578.js"></script></figure><p name="34d4" id="34d4" class="graf graf--p graf-after--figure">Since the dataset size was quite small, I used data augmentation strategies like rotation, zooming and flipping. This almost doubled the size of dataset.</p><figure name="30cc" id="30cc" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/63349ac404d616326ec91ff4afc46d28.js"></script></figure><p name="b0d5" id="b0d5" class="graf graf--p graf-after--figure">Let’s display some sample examples from each category.</p><figure name="2567" id="2567" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/3d8910fc153139139a887f96fa6bf921.js"></script></figure><figure name="98e9" id="98e9" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*jyUcigWKuLYO3-9gtEiZ2w.png" data-width="1069" data-height="1072" src="https://cdn-images-1.medium.com/max/800/1*jyUcigWKuLYO3-9gtEiZ2w.png"><figcaption class="imageCaption">Sample Products</figcaption></figure><p name="407a" id="407a" class="graf graf--p graf-after--figure">So far so good. Now comes the interesting part of the project. Let’s make the deep learning model.</p><p name="f64e" id="f64e" class="graf graf--p graf-after--p">I have used Transfer Learning using pre trained VGG weights. On top of it I used a average pooling layer to reduce the variance of the learned weights from the previous layers. Also I used 30% dropouts to reduce over-fitting. Finally I used a dense layer with 25 neurons for representing the 25 classes of grocery products in our dataset. I have used softmax as the actvation function as it is a multi class classification problem.</p><figure name="6c40" id="6c40" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/e8ed0b94787bfdc247ebce2d1e198fe5.js"></script></figure><p name="70d3" id="70d3" class="graf graf--p graf-after--figure">Let’s visualize the model.</p><figure name="a67f" id="a67f" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/a4142695910310f1f64cc0c73c8495e8.js"></script></figure><p name="b935" id="b935" class="graf graf--p graf-after--figure">I continued with defining some callbacks using keras. I used model checkpoint to save weights if validation accuracy increases. Also I used early stopping criterion if validation loss is beginning to plateau. The other 2 callbacks are for visualizing the results in tensorboard and for saving the logs in csv files.</p><figure name="f659" id="f659" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/469fa8800cc3167af9f02483bf95c7ae.js"></script></figure><p name="3316" id="3316" class="graf graf--p graf-after--figure">Next I defined the 2 optimizers. First one being a stochastic gradient descent with a learning rate of 0.0001 and momentum value of 0.99. The second one was Adam with a slightly larger learning rate of 0.001.</p><p name="d667" id="d667" class="graf graf--p graf-after--p">On comparing the two, I found that Adam was giving much better results. Also I have used categorical cross-entropy as the loss function for our model. I trained the model for 50 iterations with a batch size of 128 which I figured out to be the optimal one for this problem.</p><figure name="5c92" id="5c92" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/8ea0149fb3de5c803102797d7ae54cbd.js"></script></figure><p name="5eb2" id="5eb2" class="graf graf--p graf-after--figure">Finally I plotted the results.</p><figure name="abde" id="abde" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/abhinavsagar/e3b4dcf0d851a90d91606ebb573063f1.js"></script></figure><h3 name="1b14" id="1b14" class="graf graf--h3 graf-after--figure">Results</h3><h4 name="fa62" id="fa62" class="graf graf--h4 graf-after--h3">Loss/Accuracy vs Epoch</h4><figure name="70b8" id="70b8" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*KWiBxXa7W8fojmEUN4kuyg.png" data-width="884" data-height="319" src="https://cdn-images-1.medium.com/max/800/1*KWiBxXa7W8fojmEUN4kuyg.png"><figcaption class="imageCaption">Loss/Accuracy vs Epoch</figcaption></figure><p name="9306" id="9306" class="graf graf--p graf-after--figure">The model is able to reach a validation accuracy of 60% which is quite good considering the number of classes(25) with 100–200 images in each category. Feel free to use different architectures or play with the hyper-parameters for better results.</p><h4 name="3623" id="3623" class="graf graf--h4 graf-after--p">Correct vs Incorrect Samples</h4><figure name="9c28" id="9c28" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*Bu_fubsY4dNTXoiTt-EZjQ.png" data-width="948" data-height="1657" src="https://cdn-images-1.medium.com/max/800/1*Bu_fubsY4dNTXoiTt-EZjQ.png"><figcaption class="imageCaption">Correct vs Incorrect Samples</figcaption></figure><p name="5901" id="5901" class="graf graf--p graf-after--figure">As one can notice there are quite a few wrongly classified samples predicted by our model. But still I feel this should be a good starting point for further work in this domain.</p><h3 name="dffe" id="dffe" class="graf graf--h3 graf-after--p">Conclusions</h3><p name="699c" id="699c" class="graf graf--p graf-after--h3">Although this project is far from complete but it is remarkable to see the success of deep learning in such varied real world problems. Automatic object classification can be of great help to a food and groceries retailer in order to reduce human effort in the inventory management process of its warehouse and retail outlets. Also the friction-less store experience is being considered as the future of shopping.</p><h3 name="8091" id="8091" class="graf graf--h3 graf-after--p">References/Further Readings</h3><div name="586b" id="586b" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011" data-href="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011"><strong class="markup--strong markup--mixtapeEmbed-strong">Amazon.com: : Amazon Go</strong><br><em class="markup--em markup--mixtapeEmbed-em">Amazon Go is a new kind of store featuring the world&#39;s most advanced shopping technology. No lines, no checkout - just…</em>www.amazon.com</a><a href="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="148988f6d9ba5db46cca772bddbf4e07" data-thumbnail-img-id="0*SS1Doy4wEtf0GSEa" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*SS1Doy4wEtf0GSEa);"></a></div><div name="e06d" id="e06d" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://searchenterpriseai.techtarget.com/feature/252463246/Top-computer-vision-retail-uses-and-how-they-enhance-shopping" data-href="https://searchenterpriseai.techtarget.com/feature/252463246/Top-computer-vision-retail-uses-and-how-they-enhance-shopping" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://searchenterpriseai.techtarget.com/feature/252463246/Top-computer-vision-retail-uses-and-how-they-enhance-shopping"><strong class="markup--strong markup--mixtapeEmbed-strong">Top computer vision retail uses and how they enhance shopping</strong><br><em class="markup--em markup--mixtapeEmbed-em">The advent of the web and online shopping caused a major disruption in the retail industry. However, it was never…</em>searchenterpriseai.techtarget.com</a><a href="https://searchenterpriseai.techtarget.com/feature/252463246/Top-computer-vision-retail-uses-and-how-they-enhance-shopping" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="bf1e9b2bf6131c2007490a86e5c4efdc" data-thumbnail-img-id="0*wUU5bsSVhG1jVbg3" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*wUU5bsSVhG1jVbg3);"></a></div><div name="269e" id="269e" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://hackernoon.com/a-beginners-guide-to-computer-vision-in-retail-b5a31cfd5283" data-href="https://hackernoon.com/a-beginners-guide-to-computer-vision-in-retail-b5a31cfd5283" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://hackernoon.com/a-beginners-guide-to-computer-vision-in-retail-b5a31cfd5283"><strong class="markup--strong markup--mixtapeEmbed-strong">A beginner&#39;s guide to Computer Vision in Retail</strong><br><em class="markup--em markup--mixtapeEmbed-em">Anyone with a wet finger in the air will by now have heard of the &quot; retail apocalypse&quot; sweeping through the developed…</em>hackernoon.com</a><a href="https://hackernoon.com/a-beginners-guide-to-computer-vision-in-retail-b5a31cfd5283" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="abf8577703f74787a5f606efe12a8098" data-thumbnail-img-id="0*JmGhAwarEPYycn5h" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*JmGhAwarEPYycn5h);"></a></div><h3 name="2957" id="2957" class="graf graf--h3 graf-after--mixtapeEmbed">Before You Go</h3><p name="1a85" id="1a85" class="graf graf--p graf-after--h3">The corresponding source code can be found here.</p><div name="e4b7" id="e4b7" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/abhinavsagar/Grocery-Image-Classification" data-href="https://github.com/abhinavsagar/Grocery-Image-Classification" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/abhinavsagar/Grocery-Image-Classification"><strong class="markup--strong markup--mixtapeEmbed-strong">abhinavsagar/Grocery-Image-Classification</strong><br><em class="markup--em markup--mixtapeEmbed-em">The Freiburg Groceries Dataset consists of 5000 256x256 RGB images of 25 food classes. I have used Transfer Learning…</em>github.com</a><a href="https://github.com/abhinavsagar/Grocery-Image-Classification" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="459b4d82f32588899509826e5f5dce23"></a></div><h3 name="83f7" id="83f7" class="graf graf--h3 graf-after--mixtapeEmbed">Contacts</h3><p name="924e" id="924e" class="graf graf--p graf-after--h3">If you want to keep updated with my latest articles and projects <a href="https://medium.com/@abhinav.sagar" data-href="https://medium.com/@abhinav.sagar" class="markup--anchor markup--p-anchor" target="_blank">follow me on Medium</a>. These are some of my contacts details:</p><ul class="postList"><li name="6b94" id="6b94" class="graf graf--li graf-after--p"><a href="https://abhinavsagar.github.io" data-href="https://abhinavsagar.github.io" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Personal Website</a></li><li name="575a" id="575a" class="graf graf--li graf-after--li"><a href="https://in.linkedin.com/in/abhinavsagar4" data-href="https://in.linkedin.com/in/abhinavsagar4" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Linkedin</a></li><li name="6139" id="6139" class="graf graf--li graf-after--li"><a href="https://medium.com/@abhinav.sagar" data-href="https://medium.com/@abhinav.sagar" class="markup--anchor markup--li-anchor" target="_blank">Medium Profile</a></li><li name="2e6d" id="2e6d" class="graf graf--li graf-after--li"><a href="https://github.com/abhinavsagar" data-href="https://github.com/abhinavsagar" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">GitHub</a></li><li name="de97" id="de97" class="graf graf--li graf-after--li"><a href="https://www.kaggle.com/abhinavsagar" data-href="https://www.kaggle.com/abhinavsagar" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Kaggle</a></li></ul><p name="7505" id="7505" class="graf graf--p graf-after--li graf--trailing">Happy reading, happy learning and happy coding!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@abhinav.sagar" class="p-author h-card">Abhinav Sagar</a> on <a href="https://medium.com/p/aa4ecaaaa096"><time class="dt-published" datetime="2019-08-20T14:12:46.044Z">August 20, 2019</time></a>.</p><p><a href="https://medium.com/@abhinav.sagar/multi-class-object-classification-for-retail-products-aa4ecaaaa096" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 28, 2021.</p></footer></article></body></html>